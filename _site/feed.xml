<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">r.checagarcia</title>
<generator uri="https://github.com/jekyll/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="http://rchg.github.io/feed.xml" />
<link rel="alternate" type="text/html" href="http://rchg.github.io" />
<updated>2015-02-14T11:51:34+01:00</updated>
<id>http://rchg.github.io/</id>
<author>
  <name>R.Checa-Garcia</name>
  <uri>http://rchg.github.io/</uri>
  
</author>


  

<entry>
  <title type="html"><![CDATA[Note on WRF-gfortran-compilation]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/WRF_gfortran/" />
  <id>http://rchg.github.io/WRF_gfortran</id>
  <published>2015-01-02T00:00:00+01:00</published>
  <updated>2015-01-02T00:00:00+01:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Here I described a solution for a problem in the compilation of WRF with gfortran. The problem arrives because some comments are considered code. This was posted on the &lt;a href=&quot;http://forum.wrfforum.com/viewtopic.php?f=5&amp;amp;t=6086&quot;&gt;WRF-Forum&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;My diagnostic of that the problem is related with the &lt;strong&gt;C preprocessor&lt;/strong&gt;. A possible solution is change:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;CPP&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  /lib/cpp -C -P&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;to&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;CPP&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  /lib/cpp -P&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I think this avoid the addition of C-style comments to the .f90 files. However &lt;em&gt;this should be changed for every makefile in the directories of WRF&lt;/em&gt;. The other solution is add -cpp to the gfortran. Basically you have to change two lines:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;FORMAT_FIXED&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  -ffixed-form -cpp
&lt;span class=&quot;nv&quot;&gt;FORMAT_FREE&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  -ffree-form -ffree-line-length-none -cpp&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now the gfortran knows that cpp preprocessor is being used. The most easy way is generate the file configure.wrf as usual and before compile anything change manually those two lines by adding -cpp (and check before any compilation). Also is possible apply the changes on the ./configure script.s&lt;/p&gt;

&lt;p&gt;In my case these changes were enough to compile with gfortran. Anyway, previously to do this you may try&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gfortran -v&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;the output would be the default configuration of gfortran on your machine, and probably there isn’t anything like -cpp. I guess this output may depend partially on your Linux distribution (or Unix system).&lt;/p&gt;

&lt;p class=&quot;notice&quot;&gt;&lt;strong&gt;Other users comments:&lt;/strong&gt;
In the forum others users replied that my solution works also for &lt;em&gt;WRFDA&lt;/em&gt;. If you are using &lt;em&gt;ifort&lt;/em&gt; instead &lt;em&gt;gfortran&lt;/em&gt; another user of the forum commented that added &lt;em&gt;-fpp&lt;/em&gt; instead &lt;em&gt;-cpp&lt;/em&gt;&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/WRF_gfortran/&quot;&gt;Note on WRF-gfortran-compilation&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on January 02, 2015.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Introduction to Tikhonov Regularization Method]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/Tikhonov/" />
  <id>http://rchg.github.io/Tikhonov</id>
  <published>2014-12-12T00:00:00+01:00</published>
  <updated>2014-12-12T00:00:00+01:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Very short comment on Tikhonov regularization&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;tikhonov-regularization-method&quot;&gt;Tikhonov regularization method&lt;/h2&gt;

&lt;p&gt;This method is widely used to resolve discrete ill-posed inverse linear problems
(also non-linear). The problem it is usually establish as,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
y=F(x)
&lt;/script&gt;

&lt;p&gt;where F(x) is a linear operator, therefore we may write,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
y=Kx
&lt;/script&gt;

&lt;p&gt;The solution of the inverse discrete problem its usually described with the singular value decomposition (SVD). Then it is defined the pseudoinverse of K as,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
K^{\dagger}=(K^{T}K)^{-1}K^{T}=V\Sigma^{\dagger}U^{T}
&lt;/script&gt;

&lt;p&gt;The Tikhonov regularization propose another definition of the pseudoinverse which includes a regularization matrix &lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;
and a regularization parameter &lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
K^{\dagger}=(K^{T}K+\alpha L^{T}L)^{-1}K^{T}=\bar{V}\Sigma^{\dagger}_{\alpha}\bar{U}^{T}
&lt;/script&gt;

&lt;p&gt;In order to write the last equation the generalized singular value decomposition (GSVD) is used.&lt;/p&gt;

&lt;h3 id=&quot;measurements-with-noise1&quot;&gt;Measurements with noise&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h3&gt;

&lt;p&gt;The inversion method has an additional difficulty when the measurements incorporate errors, usually modelled as Gaussian Errors. In that case the vector state solution, written as &lt;script type=&quot;math/tex&quot;&gt;x^{\epsilon}&lt;/script&gt; is related with the noisy measurements &lt;script type=&quot;math/tex&quot;&gt;y^{\epsilon}&lt;/script&gt;. The problem is formulated now as:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
y^{\epsilon}=Kx^{\epsilon}
&lt;/script&gt;

&lt;p&gt;and the additional problem is not just how to calculate the singular values, but how different are the estimation &lt;script type=&quot;math/tex&quot;&gt;x^{\epsilon}&lt;/script&gt; and the true value &lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;. &lt;/p&gt;

&lt;p&gt;However also there is a methodological problem on the definition of the solution &lt;script type=&quot;math/tex&quot;&gt;x^{\epsilon}&lt;/script&gt; given that is not true that always &lt;script type=&quot;math/tex&quot;&gt;y^{\delta}\in Im(K)&lt;/script&gt;. Therefore, a new concept of solution is needed and it is usually formulated as an optimization rule:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
x^{\epsilon}: ||y^{\epsilon}-Kx^{\epsilon}||\le||y^{\epsilon}-Kx||\,\,\, \forall x \in \mathcal{X}
&lt;/script&gt;

&lt;p&gt;where &lt;script type=&quot;math/tex&quot;&gt;\mathcal{X}&lt;/script&gt; is the domain of the Forward Model.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Doicu, Adrian, Thomas Trautmann, and Franz Schreier. Numerical regularization for atmospheric inverse problems. Springer, 2010. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/Tikhonov/&quot;&gt;Introduction to Tikhonov Regularization Method&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on December 12, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Performance and Python (I)]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/python-performance-1/" />
  <id>http://rchg.github.io/python-performance-1</id>
  <published>2014-12-05T00:00:00+01:00</published>
  <updated>2014-12-05T00:00:00+01:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;p&gt;In this post, I will introduce a python library quite useful to evaluate the most critical functions in your code (those that are most often called, and those where the program spent more time). To better understand how this library actually works, a good method is explain an example.&lt;/p&gt;

&lt;p&gt;Therefore, I will use a numerical python code that I programmed to calculate the scattering properties of homogeneous spheres with Mie Scattering. The calculation needs the values of the Mie angular functions which are defined by recurrence relations (&lt;a href=&quot;http://http://rchg.github.io/Mie-Scattering/&quot;&gt;see this post&lt;/a&gt; ). Typically, we have to program functions like,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
S_{1}(\theta) = \sum_{n=1}^{N_{max}}\frac{2n+1}{n(n+1)}\left[ a_{n}\pi_{n}(\theta)+b_{n}\tau_{n}(\theta) \right]
&lt;/script&gt;

&lt;p&gt;where,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\pi_{n}(\theta)=f(\pi_{n-1}(\theta),\pi_{n-2}(\theta))
&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\tau_{n}(\theta)=g(\pi_{n-1}(\theta),\pi_{n-2}(\theta))
&lt;/script&gt;

&lt;p&gt;at this point the specific form of the functions &lt;script type=&quot;math/tex&quot;&gt;f&lt;/script&gt; and &lt;script type=&quot;math/tex&quot;&gt;g&lt;/script&gt; is not critical. But if we analized the equation of &lt;script type=&quot;math/tex&quot;&gt;S_{1}(\theta)&lt;/script&gt; there is a sum of $\pi_{n}(\theta)$ for increasing values of n. Due to the recurrence definition we have to evaluate several times similar or identical expressions.&lt;/p&gt;

&lt;p&gt;Let’s say that in first instance we are not aware of this fact, however we want to diagnose where the code spends more time and resources. For that we install the library:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pip install pycallgraph&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We could use the library like a bash shell program or import it within our program. In the first case,&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pycallgraph graphviz -- testTHIS.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This will generate a image file &lt;strong&gt;pycallgraph.png&lt;/strong&gt;. However, it is more useful and versatile to introduce directly in the script because it is possible to diagnose expecifically a function or block of code: &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pymie_core&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pymie&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pycallgraph&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyCallGraph&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pycallgraph.output&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GraphvizOutput&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyCallGraph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GraphvizOutput&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pymie&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mie_scat_lognormals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a_sig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a_mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In this case I would like to evaluate the function &lt;strong&gt;mie_scat_lognormals&lt;/strong&gt;. Within this function &lt;strong&gt;mie_scat_lognormals&lt;/strong&gt; of the library pymie_core are calculated series of the type: &lt;script type=&quot;math/tex&quot;&gt;S_{1}(\theta)&lt;/script&gt;. &lt;/p&gt;

&lt;p&gt;If we just execute our python script we will find an image file, which in this case is,&lt;/p&gt;

&lt;figure&gt;
&lt;img src=&quot;/images/pycallgraph_before_2.png&quot; /&gt;
	&lt;figcaption&gt;&lt;a title=&quot;Graphviz Image&quot;&gt;Graphviz Image to analyze the function pymie.mie_scat_lognormals.&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;I have indicated the large number of evaluations of the Mie angular functions. Therefore this motivate check the code because any improvement would mean a much better performance. In this code, I introduced a main change storing in a numpy array the results of the mie angular functions to avoid the huge number of evaluations. The result of run again the python script is now,&lt;/p&gt;

&lt;figure&gt;
&lt;img src=&quot;/images/pycallgraph_2.png&quot; /&gt;
	&lt;figcaption&gt;&lt;a title=&quot;Graphviz Image&quot;&gt;Graphviz Image to check the function pymie.mie_scat_lognormals after the code improvement.&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;We appreciate that before there was &lt;script type=&quot;math/tex&quot;&gt;4\,300\,000&lt;/script&gt;  calls and after &lt;script type=&quot;math/tex&quot;&gt;300\,000&lt;/script&gt; function calls. By using this library we could figure out where our code is spending more time and what functions are critical in terms of global perfomance.  &lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/python-performance-1/&quot;&gt;Performance and Python (I)&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on December 05, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Online Coupled Models]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/Online-Coupled-Models/" />
  <id>http://rchg.github.io/Online-Coupled-Models</id>
  <published>2014-11-20T00:00:00+01:00</published>
  <updated>2014-11-20T00:00:00+01:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Post under construction: In this post I am writing step by step the topics I am learning about Online Coupled Models. &lt;/p&gt;
&lt;/blockquote&gt;

&lt;p class=&quot;smallblock&quot;&gt;&lt;strong&gt;Definition&lt;/strong&gt;: By Online Coupled Models (OCM) I understand a numerical weather prediction model (NWPM) -or a climate model, global or regional- that includes also a parameterization with the gases chemistry and/or an aerosols physics-chemistry (if both are included they has to be also linked with a gas-phase module) &lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. The term online is included because there is an update of the NWPM due to the parameterizations. An offline chemistry transport model means a chemistry model whose transport and interaction are conditioned by the meteorological fields (but it is unidirectional). Note: The concept of online coupled model may be applied also to ocean-atmosphere coupling, here I am not commenting about that case.&lt;/p&gt;

&lt;h4 id=&quot;spatial-temporal-resolutions&quot;&gt;Spatial-temporal Resolutions&lt;/h4&gt;

&lt;p&gt;Few years ago most of the NWPM were &lt;strong&gt;hydrostatic&lt;/strong&gt;. An approximation that constrained the spatial resolution to values larger than (around) 15-20 km. However recently most of the NWPM (global climate models usually have larger spatial resolutions) are actually &lt;strong&gt;non-hydrostatic&lt;/strong&gt;&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;#fn:4&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. However smaller spatial resolution also means improve the physical parameterizations and physical descriptions (and also increase the temporal resolution), a classical example is the convection. When the scale is highly improved some authors speak about &lt;strong&gt;Cloud-Resolving-Models&lt;/strong&gt; or &lt;strong&gt;Convection-Resolving-Models(CRM)&lt;/strong&gt;&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;. The aerosols and chemistry can be included on several model scales, but I understand that higher resolution will means be careful about the quality of the parametrization and its relations with cloud micro-physics and precipitation. &lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
&lt;a href=&quot;http://www.dwd.de/bvbw/generator/DWDWWW/Content/Oeffentlichkeit/FE/Bilder/ASFU__NM__Phys__Par__skalentrennung__en__580,property=default.jpg&quot;&gt;&lt;img src=&quot;http://www.dwd.de/bvbw/generator/DWDWWW/Content/Oeffentlichkeit/FE/Bilder/ASFU__NM__Phys__Par__skalentrennung__en__580,property=default.jpg&quot; /&gt;&lt;/a&gt;
&lt;a href=&quot;http://www.clm-community.eu/images/13_Picture1_1403507274.jpg&quot;&gt;&lt;img src=&quot;http://www.clm-community.eu/images/13_Picture1_1403507274.jpg&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;&lt;a title=&quot;Illustration of Spatial Resolutions&quot;&gt;Illustration of Spatial Resolutions (sources:DWD and www.clm-community.eu)&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h4 id=&quot;objectives&quot;&gt;Objectives&lt;/h4&gt;

&lt;p&gt;There are advantages of the online coupled is that they may use to study the role of aerosols on the global radiative forcing &lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;. Also the aerosols are the source of Cloud-Condensation-Nucleus (CCN) that plays a central role on the cloud micro-physics. &lt;/p&gt;

&lt;h4 id=&quot;general-framework&quot;&gt;General framework&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;Section under construction.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;balance-equations&quot;&gt;Balance equations&lt;/h4&gt;

&lt;p&gt;It is quite interesting that the parameterizations of several physical processes are described with &lt;strong&gt;balance equations&lt;/strong&gt;. The first step is define several categories: like aerosols types or like drops sizes… The physical process are the interpreted as effective transferences from a category to another one. For instance, the breakup of a rain drop in two others will be represented by an increase the concentration of one category and decrease on another. This kind of processed can written as &lt;strong&gt;balance equations&lt;/strong&gt;. That in a warm cloud micro-physics scheme would imply total water vapor mass conservation.&lt;/p&gt;

&lt;p&gt;Describe the aerosols dynamics is quite complex due to the several physical processes involved: cloud micro-physics, chemistry, precipitation etc… But the dynamic processed between aerosols is usually modeled by balance equations like (k represents here a mode-category),&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\partial_{t}N_{k}={\overbrace{T(N_{k})}^{Turbulent\,Transp.}}+{\overbrace{A(N_{k})}^{Advection \, Transp.}}+{\overbrace{v_{s}\partial_{z}(N_{k})}^{Sedimentation}}-{\overbrace{C\sum_{l}a_{k,l}}^{Balance\,between: k, l}}
&lt;/script&gt;

&lt;h5 id=&quot;references-and-notes&quot;&gt;References and Notes&lt;/h5&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Baklanov, A. et al. (2014): Online coupled regional meteorology chemistry models in Europe: current status and prospects, &lt;em&gt;Atmos. Chem. Phys.&lt;/em&gt;, 14, 317-398, &lt;a href=&quot;http://dx.doi.org/10.5194/acp-14-317-2014&quot;&gt;doi-link&lt;/a&gt;. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:4&quot;&gt;
      &lt;p&gt;Marshall, J., C. Hill, L. Perelman, and A. Adcroft (1997), Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling, J. Geophys. Res., 102(C3), 5733–5752, &lt;a href=&quot;http://dx.doi.org/10.1029/96JC02776&quot;&gt;doi-link&lt;/a&gt;. &lt;a href=&quot;http://www-paoc.mit.edu/paoc/papers/hydrostatic.pdf&quot;&gt;pdf-link&lt;/a&gt;. &lt;a href=&quot;#fnref:4&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;Ban, N., J. Schmidli, and C. Schär (2014), Evaluation of the convection-resolving regional climate modeling approach in decade-long simulations, &lt;em&gt;J. Geophys. Res. Atmos.&lt;/em&gt;, 119, 7889–7907, &lt;a href=&quot;http://dx.doi.org/10.1002/2014JD021478&quot;&gt;doi-link&lt;/a&gt;. &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:3&quot;&gt;
      &lt;p&gt;Kristina Lundgren, Direct Radiative Effects of Sea Salt on the Regional Scale, &lt;em&gt;KIT Scientific Publishing 2012&lt;/em&gt;, ISSN 0179-5619, ISBN 978-3-86644-773-8. &lt;a href=&quot;http://www.imk-tro.kit.edu/english/3140_5642.php&quot;&gt;pdf-link&lt;/a&gt;. &lt;a href=&quot;#fnref:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/Online-Coupled-Models/&quot;&gt;Online Coupled Models&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on November 20, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Mie Scattering]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/Mie-Scattering/" />
  <id>http://rchg.github.io/Mie-Scattering</id>
  <published>2014-11-20T00:00:00+01:00</published>
  <updated>2014-11-20T00:00:00+01:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Post under construction&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p class=&quot;smallblock&quot;&gt;&lt;strong&gt;Definition&lt;/strong&gt;: Mie Scattering is a solution of the scattering problem described with the Maxwell Equations when the scatter is a spherical particle. Initially the solution of Mie (or Lorenz-Mie) was designed for homogeneous spheres, however there are extensions for multi-layered spheres and with important limitations for other geometrical objects. The calculation is relatively efficient but depends on the &lt;strong&gt;size parameter&lt;/strong&gt;, &lt;script type=&quot;math/tex&quot;&gt;x=2\pi r/\lambda&lt;/script&gt;. When this parameter increases the number of terms of the series necessaries to calculate the relevant amounts also grows.&lt;/p&gt;

&lt;h3 id=&quot;the-scattering-problem&quot;&gt;The Scattering problem&lt;/h3&gt;

&lt;p&gt;The scattering problem can be formulated within the Maxwell Theory as,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\vec{E}_{s}=f(R)\mathbf{S}(\Omega)\vec{E}_{i}&lt;/script&gt;

&lt;p&gt;where &lt;script type=&quot;math/tex&quot;&gt;\vec{E}_{s}&lt;/script&gt; its the scattered electric field vector and &lt;script type=&quot;math/tex&quot;&gt;\vec{E}_{i}&lt;/script&gt; its the incident electric field. &lt;script type=&quot;math/tex&quot;&gt;\mathbf{S}(\Omega)&lt;/script&gt; is the &lt;strong&gt;scattering matrix&lt;/strong&gt; (a 2x2 matrix). We have indicated a dependence on solid angle &lt;script type=&quot;math/tex&quot;&gt;\Omega&lt;/script&gt;. In the case of isotropic spheres the dependency its only &lt;script type=&quot;math/tex&quot;&gt;\vec{k}_{i}\cdot \vec{k}_{s}=cos(\theta)&lt;/script&gt;. And &lt;script type=&quot;math/tex&quot;&gt;f(R)&lt;/script&gt; it is just a function of the distance (we are usually in &lt;em&gt;far field approximation&lt;/em&gt;). In general the scattering matrix its a complex matrix.&lt;/p&gt;

&lt;p&gt;For spheres (and probably also for any set of scatters with randomly oriented axis) the scattering matrix is diagonal. &lt;/p&gt;

&lt;h3 id=&quot;the-phase-matrix&quot;&gt;The Phase Matrix&lt;/h3&gt;

&lt;p&gt;In the Atmospheric Radiation studies it is quite common use the &lt;strong&gt;Stokes vector&lt;/strong&gt;, so we have an incident stokes vector &lt;script type=&quot;math/tex&quot;&gt;\vec{I}_{i}&lt;/script&gt; and an scattered stokes vector &lt;script type=&quot;math/tex&quot;&gt;\vec{I}_{s}&lt;/script&gt; and the scattering problem is written as&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\vec{I}_{s}=h(R)\mathbf{F}(\Omega)\vec{I}_{i}&lt;/script&gt;

&lt;p&gt;here &lt;script type=&quot;math/tex&quot;&gt;\mathbf{F}(\Omega)&lt;/script&gt; its a 4x4 real matrix called &lt;strong&gt;Transformation Matrix&lt;/strong&gt; &lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{bmatrix}
  F_{11}(\theta) &amp; F_{12}(\theta) &amp; 0 &amp; 0 \\
  F_{21}(\theta) &amp; F_{22}(\theta) &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; F_{33}(\theta) &amp; F_{34}(\theta) \\
  0 &amp; 0 &amp; F_{43}(\theta) &amp; F_{44}(\theta)
\end{bmatrix}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;while the &lt;strong&gt;Phase Matrix&lt;/strong&gt; is the transformation matrix with a factor proportional to the scattering cross-section that we will introduce later. Both formulations of the problem are equivalent as the real elements of the Phase Matrix can be estimated from the complex elements of the scattering matrix, in fact theMie Scattering theory gives us a method to calculate the &lt;strong&gt;scattering matrix&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;The scattering matrix can be written as,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{bmatrix}
  S_{1}(\theta) &amp; 0 \\
  0  &amp; S_{2}(\theta) 
\end{bmatrix}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;with&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
S_{1}(\theta) = \sum_{n=1}^{N_{max}}\frac{2n+1}{n(n+1)}\left[ a_{n}\pi_{n}(\theta)+b_{n}\tau_{n}(\theta) \right]
&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
S_{2}(\theta) = \sum_{n=1}^{N_{max}}\frac{2n+1}{n(n+1)}\left[ b_{n}\pi_{n}(\theta)+a_{n}\tau_{n}(\theta) \right]
&lt;/script&gt;

&lt;p&gt;The series of values &lt;script type=&quot;math/tex&quot;&gt;A_{Nmax}=\{a_{n}, \, n=1, N_{max}\}&lt;/script&gt;, &lt;script type=&quot;math/tex&quot;&gt;B_{Nmax}=\{b_{n}, \, n=1, N_{max}\}&lt;/script&gt;, are estimated from spherical Bessel functions. &lt;/p&gt;

&lt;p&gt;These series are used directly to calculate the Efficiency Factor of Extinction, scattering and absorption. But also the single albedo, or the asymmetry factor. &lt;/p&gt;

&lt;figure&gt;
&lt;img src=&quot;/images/Sphere_Mie_Scatt_web.png&quot; /&gt;
	&lt;figcaption&gt;&lt;a title=&quot;Illustration of Mie Scattering properties: homogeneous sphere and several values of the refractive index.&quot;&gt; Illustration of Mie Scattering properties: homogeneous sphere and several values of the refractive index.&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p class=&quot;smallblock&quot;&gt;&lt;strong&gt;Note&lt;/strong&gt;: The called T-matrix formalism it is an efficient alternative to Mie-Scattering. In particular, the T-matrix formalism is quite convinient for raindrop studies because the estimation of the scattering properties of Oblate Spheroid and Chebyshev particles is relatively easy described. The idea behind the theory is appealing: (1). The incident and scattered electric fields are expresed as a sum of spherical functions whose coeficientes, before and after the scattering process, might be related by a linear expression involving a &lt;strong&gt;transition matrix&lt;/strong&gt; or T-matrix. (2). By using numerical or analytical methods expressions of this transition matrix are calculated and based on the transition matrix the optical properties estimated.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Hansen, J.E., and L.D. Travis, 1974: Light scattering in planetary atmospheres. Space Sci. Rev., 16, 527-610, doi:10.1007/BF00168069. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/Mie-Scattering/&quot;&gt;Mie Scattering&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on November 20, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Notes on HDF5]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/HDF5/" />
  <id>http://rchg.github.io/HDF5</id>
  <published>2014-10-20T00:00:00+02:00</published>
  <updated>2014-10-20T00:00:00+02:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Still under construction… mainly a collection of information of the manual at this stage…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;An HDF5 file is a container for storing a variety of scientific data and is composed of two primary types of objects: groups and datasets.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;HDF5 group&lt;/strong&gt;: a grouping structure containing zero or more HDF5 objects, together with supporting metadata&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;HDF5 dataset&lt;/strong&gt;: a multidimensional array of data elements, together with supporting metadata&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Any HDF5 group or dataset may have an associated &lt;em&gt;attribute list&lt;/em&gt;. An HDF5 attribute is a user-defined HDF5 structure that provides extra information about an HDF5 object.&lt;/p&gt;

&lt;p&gt;Working with groups and datasets is similar in many ways to working with directories and files in UNIX. As with UNIX directories and files, an HDF5 object in an HDF5 file is often referred to by its full path name (also called an absolute path name).&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;/&lt;/strong&gt; means the root group.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;/foo&lt;/strong&gt; means a member of the root group called foo.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;/foo/zoo&lt;/strong&gt; means a member of the group foo, which in turn is a member of the root group.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;hdf5-groups&quot;&gt;HDF5 Groups&lt;/h4&gt;

&lt;p&gt;An HDF5 group is a structure containing zero or more HDF5 objects. A group has two parts:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A group header, which contains a group name and a list of group attributes.&lt;/li&gt;
  &lt;li&gt;A group symbol table, which is a list of the HDF5 objects that belong to the group.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;hdf5-datasets&quot;&gt;HDF5 Datasets&lt;/h4&gt;

&lt;p&gt;A dataset is stored in a file in two parts: a header and a data array.&lt;/p&gt;

&lt;p&gt;The header contains information that is needed to interpret the array portion of the dataset, as well as metadata (or pointers to metadata) that describes or annotates the dataset. Header information includes the name of the object, its dimensions, its number-type, information about how the data itself is stored on disk, and other information used by the library to speed up access to the dataset or maintain the file’s integrity.&lt;/p&gt;

&lt;p&gt;There are four essential classes of information in any header: name, datatype, dataspace, and storage layout:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;_Name_&lt;/code&gt;. A dataset name is a sequence of alphanumeric ASCII characters.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;_Datatype_&lt;/code&gt;. HDF5 allows one to define many different kinds of datatypes. There are two categories of datatypes: atomic datatypes and compound datatypes. Atomic datatypes can also be system-specific, or NATIVE, and all datatypes can be names:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Atomic datatypes include integers and floating-point numbers. Each atomic type belongs to a particular class and has several properties: size, order, precision, and offset. In this introduction, we consider only a few of these properties.&lt;/p&gt;

&lt;p&gt;Atomic classes include integer, float, string, bit field, and opaque. (Note: Only integer, float and string classes are available in the current implementation.)&lt;/p&gt;

&lt;p&gt;Properties of integer types include size, order (endian-ness), and signed-ness (signed/unsigned).&lt;/p&gt;

&lt;p&gt;Properties of float types include the size and location of the exponent and mantissa, and the location of the sign bit.&lt;/p&gt;

&lt;p&gt;The datatypes that are supported in the current implementation are:&lt;/p&gt;

&lt;p&gt;NATIVE datatypes. Although it is possible to describe nearly any kind of atomic datatype, most applications will use predefined datatypes that are supported by their compiler. In HDF5 these are called native datatypes. NATIVE datatypes are C-like datatypes that are generally supported by the hardware of the machine on which the library was compiled. In order to be portable, applications should almost always use the NATIVE designation to describe data values in memory.&lt;/p&gt;

&lt;p&gt;(See Datatypes in the HDF User’s Guide for further information.)&lt;/p&gt;

&lt;p&gt;A &lt;strong&gt;compound datatype&lt;/strong&gt; is one in which a collection of several datatypes are represented as a single unit, a compound datatype, similar to a struct in C. The parts of a compound datatype are called members. The members of a compound datatype may be of any datatype, including another compound datatype. It is possible to read members from a compound type without reading the whole type.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Named datatypes&lt;/strong&gt;. Normally each dataset has its own datatype, but sometimes we may want to share a datatype among several datasets. This can be done using a named datatype. A named datatype is stored in the file independently of any dataset, and referenced by all datasets that have that datatype. Named datatypes may have an associated attributes list. See Datatypes in the HDF User’s Guide for further information.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Dataspace&lt;/strong&gt;. A dataset dataspace describes the dimensionality of the dataset. The dimensions of a dataset can be fixed (unchanging), or they may be unlimited, which means that they are extendible (i.e. they can grow larger).&lt;/p&gt;

&lt;p&gt;Properties of a dataspace consist of the rank (number of dimensions) of the data array, the actual sizes of the dimensions of the array, and the maximum sizes of the dimensions of the array. For a fixed-dimension dataset, the actual size is the same as the maximum size of a dimension. When a dimension is unlimited, the maximum size is set to the value H5P_UNLIMITED. (An example below shows how to create extendible datasets.)&lt;/p&gt;

&lt;p&gt;A dataspace can also describe portions of a dataset, making it possible to do partial I/O operations on selections. Selection is supported by the dataspace interface (H5S). Given an n-dimensional dataset, there are currently four ways to do partial selection:&lt;/p&gt;

&lt;p&gt;Since I/O operations have two end-points, the raw data transfer functions require two dataspace arguments: one describes the application memory dataspace or subset thereof, and the other describes the file dataspace or subset thereof.&lt;/p&gt;

&lt;p&gt;(See Dataspaces and Partial I/O in the HDF User’s Guide for further information.)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Storage layout&lt;/strong&gt;. The HDF5 format makes it possible to store data in a variety of ways. The default storage layout format is contiguous, meaning that data is stored in the same linear way that it is organized in memory. Two other storage layout formats are currently defined for HDF5: compact, and chunked. In the future, other storage layouts may be added.&lt;/p&gt;

&lt;p&gt;Compact storage is used when the amount of data is small and can be stored directly in the object header. (Note: Compact storage is not supported in this release.)&lt;/p&gt;

&lt;p&gt;Chunked storage involves dividing the dataset into equal-sized “chunks” that are stored separately. Chunking has three important benefits.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;It makes it possible to achieve good performance when accessing subsets of the datasets, even when the subset to be chosen is orthogonal to the normal storage order of the dataset.&lt;/li&gt;
  &lt;li&gt;It makes it possible to compress large datasets and still achieve good performance when accessing subsets of the dataset.&lt;/li&gt;
  &lt;li&gt;It makes it possible efficiently to extend the dimensions of a dataset in any direction.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(See Datasets in the HDF User’s Guide for further information. Also see Dataset Chunking Issues.)&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/HDF5/&quot;&gt;Notes on HDF5&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on October 20, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Note on netCDF-Fortran]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/netCDF-Fortran/" />
  <id>http://rchg.github.io/netCDF-Fortran</id>
  <published>2014-10-10T00:00:00+02:00</published>
  <updated>2014-10-10T00:00:00+02:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Note that: The kind of compilation I will describe needs .a libraries. This means that we should be sure that the package installed contains the required .a libraries. For example, for hdf5 (at least in Debian) you should install &lt;em&gt;hdf5-dev&lt;/em&gt; package.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;compile-a-fortran-program-which-uses-netcdf-library&quot;&gt;Compile a Fortran program which uses netcdf library&lt;/h3&gt;

&lt;p&gt;After install the libraries &lt;em&gt;hdf5&lt;/em&gt; and &lt;em&gt;hdf5-dev&lt;/em&gt; and their dependences. A good idea is just run in the terminal the command &lt;strong&gt;nc-config&lt;/strong&gt;. &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc-config -all

  --cc        -&amp;gt; gcc
  --cflags    -&amp;gt;  -I/usr/include -DgFortran
  --libs      -&amp;gt; -L/usr/lib -lnetcdf

  --cxx       -&amp;gt; g++
  --has-c++   -&amp;gt; yes

  --fc        -&amp;gt; gfortran
  --fflags    -&amp;gt; -g -O2 -I/usr/include
  --flibs     -&amp;gt; -L/usr/lib -lnetcdff -lnetcdf
  --has-f77   -&amp;gt; yes
  --has-f90   -&amp;gt; yes

  --has-dap   -&amp;gt; yes
  --has-nc2   -&amp;gt; yes
  --has-nc4   -&amp;gt; yes
  --has-hdf5  -&amp;gt; yes
  --has-hdf4  -&amp;gt; no
  --has-pnetcdf-&amp;gt; no
  --has-szlib -&amp;gt; 

  --prefix    -&amp;gt; /usr
  --includedir-&amp;gt; /usr/include
  --version   -&amp;gt; netCDF 4.1.3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;As you will see this gives information about all flags and tips to compile with this library. More specifically two commands are particularly useful for FORTRAN:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc-config --flibs 
-L/usr/lib -lnetcdff -lnetcdf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc-config --fflags &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
-g -O2 -I/usr/include&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Gives information about &lt;em&gt;*how to give information to the compiler about libs&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;Gives information about &lt;strong&gt;flags&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Therefore compilation of a &lt;strong&gt;program.f90&lt;/strong&gt; that is using the netcdf library would be:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gfortran program.f90 -o program.out -L/usr/lib -lnetcdff -lnetcdf -g -O2 -I/usr/include&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Easy, isn’t it?&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/netCDF-Fortran/&quot;&gt;Note on netCDF-Fortran&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on October 10, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Matplotlib tips]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/matplotlib-intro/" />
  <id>http://rchg.github.io/matplotlib-intro</id>
  <published>2014-10-02T00:00:00+02:00</published>
  <updated>2014-10-02T00:00:00+02:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;This post has a list of tiny matplotlib tips. &lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;how-to-change-the-fonts&quot;&gt;How to Change the fonts&lt;/h3&gt;

&lt;p&gt;There are several possible directories where the matplotlib preference files are stored. In my Linux Distribution they are at &lt;em&gt;/home/USER/.matplotlib&lt;/em&gt;, therefore to see if a specific font is avaliable we could write in the terminal.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;more .matplotlib/fontList.cache &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep Gentium&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Because this file has the names on the fontList.cache of matplotlib then to choose one font, for example, &lt;em&gt;Gentium Basic&lt;/em&gt; that we have checked that is in &lt;strong&gt;fontList.cache&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;mlp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;font.family&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Gentium Basic&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Also this can be change directly in the matplotlib rc file. I recommend also take a look to the &lt;a href=&quot;http://matplotlib.org/api/font_manager_api.html&quot;&gt;matplotlib font API&lt;/a&gt;.&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/matplotlib-intro/&quot;&gt;Matplotlib tips&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on October 02, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[pr, cut, grep...]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/UNIX-tools/" />
  <id>http://rchg.github.io/UNIX-tools</id>
  <published>2014-10-02T00:00:00+02:00</published>
  <updated>2014-10-02T00:00:00+02:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;This post collects a list of shorts tips related with UNIX terminal tools. To extract information of a file, to find specific archives, etc …&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;awk-and-pr&quot;&gt;awk and pr&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;AWK&lt;/strong&gt; is a quite powerful line command, here I will just comment an example of how to combine it with &lt;strong&gt;pr&lt;/strong&gt;. The &lt;strong&gt;pr&lt;/strong&gt; command is useful to, for example, create a one two column file from two previous one column files (or more complex operations)  &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cp &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;-file.dat del_2300
awk &lt;span class=&quot;s1&quot;&gt;&amp;#39;{print $1, $NF}&amp;#39;&lt;/span&gt; del_2300 &amp;gt; DEL2300
mv DEL2 DEL_0000
mv DEL_0000 DEL0000
cp &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;-file.dat del_2300
awk &lt;span class=&quot;s1&quot;&gt;&amp;#39;{print $1, $NF}&amp;#39;&lt;/span&gt; del_2300 &amp;gt; DEL2300
awk &lt;span class=&quot;s1&quot;&gt;&amp;#39;{print $1, $NF}&amp;#39;&lt;/span&gt; del &amp;gt; DEL0000
pr -m -t -s&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;DEL0000 DEL2300 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; gawk &lt;span class=&quot;s1&quot;&gt;&amp;#39;{print $1,$2,$3,$4}&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;cut&quot;&gt;cut&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cut -f 
cut -c &lt;span class=&quot;m&quot;&gt;129&lt;/span&gt; file.txt &amp;gt; new_file.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;(THIS save only the character column number 129)&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/UNIX-tools/&quot;&gt;pr, cut, grep...&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on October 02, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Review of A First Course in Atmospheric Radiation]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/Book-Review/" />
  <id>http://rchg.github.io/Book-Review</id>
  <published>2014-10-01T00:00:00+02:00</published>
  <updated>2014-10-01T00:00:00+02:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Introductory book to the Physics of radiation, with emphasis on atmospheric related applications. The book contains a good selection of exercises and it was written with a easy to read style&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The book of G.W. Petty about Atmospheric Radiation (see here) , while it is an introductory book contains almost every topic that a university student or young researcher may need. Just I missed a more detailed further reading section to guide the reader a little bit more to the field.&lt;/p&gt;

&lt;p&gt;The previous knowledge needed to follow the book is just the logical mathematical skills and a capacity to follow the physics reasoning of the author. But the book doesn’t rely too much on Electromagnetic or Optics physics with is only used at the beginning of the book to explain the nature of the light. The book, as usual in this field cover the phenomena of absorption, emission and scattering of light which always are described focused on atmospheric radiation applications. Equations for multiple scattering radiation transfer theory are included together with the typical Legendre Polynomial based expansion of the Phase Function, but probably additional information would needed for those reader most interested on the mathematical side of radiative transfer theory. The practical problem of line by line calculation and the k-correlation approach to solve (partially) this problem is successfully and very intuitively explained. In general the goal of the author of explain to the reader the way of reasoning on atmospheric radiation is nicely achieved.&lt;/p&gt;

&lt;p&gt;The readers interested on remote sensing by satellite in subjects like atmospheric chemistry or cloud physics without a previous background on this applications will find quite useful have this book close in the working desk.&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/Book-Review/&quot;&gt;Review of A First Course in Atmospheric Radiation&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on October 01, 2014.&lt;/p&gt;</content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Review of An Introduction to Atmospheric Physics]]></title>
  <link rel="alternate" type="text/html" href="http://rchg.github.io/Book-Review-2/" />
  <id>http://rchg.github.io/Book-Review-2</id>
  <published>2013-10-31T00:00:00+01:00</published>
  <updated>2013-10-31T00:00:00+01:00</updated>
  <author>
    <name>R. Checa-Garcia</name>
    <uri>http://rchg.github.io</uri>
    
  </author>
  <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Concise Review of the introductory book to Atmospheric Physics written by David G. Andrews. Personally I founded it more useful on several aspects than the broadly known book “Atmospheric Science (an introductory survey)” of J.M.Wallace, which probably gives too many details to the reader instead of focus on the relevant physical meaning. Probably this last book is more useful like a general reference.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The author presents an concise introduction to several topics on Atmospheric Physics. No previous knowledge is supposed and the different subjects are explained on a consistent exposition mainly self-contained.&lt;/p&gt;

&lt;p&gt;For a undergraduate students of any scientific discipline it is a interesting introduction book. In my personal opinion I have found his concise approach more useful than other more encyclopedic books like Atmospheric Science of John M. Wallace and Peter V. Hobbs, at least for a beginner. The topics of atmospheric thermodynamics, basic fluid dynamics or radiative transfer theory are well exposed with a minimum previous knowledge on physics and mathematics. However if the reader is looking for other topics like conceptual models on meteorology, cloud physics or data-assimilation applied to atmospheric physics other references are needed.&lt;/p&gt;

&lt;p&gt;The problems contained on each chapter provide a necessary complement to understand correctly the topics described. And finally the set of references is enough, but probably a student with interest on an specific subject may need more sources of information for the bibliography.&lt;/p&gt;

&lt;p&gt;In my opinion, a good book that I recommend for introductory courses on sciences under-graduate programs.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://rchg.github.io/Book-Review-2/&quot;&gt;Review of An Introduction to Atmospheric Physics&lt;/a&gt; was originally published by R. Checa-Garcia at &lt;a href=&quot;http://rchg.github.io&quot;&gt;r.checagarcia&lt;/a&gt; on October 31, 2013.&lt;/p&gt;</content>
</entry>

</feed>
